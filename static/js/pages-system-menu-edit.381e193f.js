(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-system-menu-edit"],{"8ede":function(t,n,a){"use strict";a.d(n,"b",(function(){return e})),a.d(n,"c",(function(){return u})),a.d(n,"a",(function(){return i}));var i={uniForms:a("71e4").default,uniFormsItem:a("bed4").default,uniLink:a("97b7").default,uniDataChecklist:a("14f6").default},e=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("v-uni-view",{staticClass:"uni-container"},[a("uni-forms",{ref:"form",attrs:{labelWidth:"80",rules:t.rules,validateTrigger:"bind"},on:{submit:function(n){arguments[0]=n=t.$handleEvent(n),t.submit.apply(void 0,arguments)}},model:{value:t.formData,callback:function(n){t.formData=n},expression:"formData"}},[a("uni-forms-item",{attrs:{name:"menu_id",label:"标识"}},[a("v-uni-input",{staticClass:"uni-input-border uni-disabled",attrs:{disabled:!0,placeholder:"菜单项的ID，不可重复",value:t.formData.menu_id},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("menu_id",n.detail.value)}}})],1),a("uni-forms-item",{attrs:{name:"name",label:"名称"}},[a("v-uni-input",{staticClass:"uni-input-border",attrs:{placeholder:"菜单名称",value:t.formData.name},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("name",n.detail.value)}}})],1),a("uni-forms-item",{staticStyle:{"margin-bottom":"40px"},attrs:{name:"icon",label:"图标"}},[a("v-uni-input",{staticClass:"uni-input-border",attrs:{placeholder:"菜单图标",value:t.formData.icon},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("icon",n.detail.value)}}}),a("uni-link",{staticClass:"uni-form-item-tips",attrs:{"font-size":"12",href:"https://uniapp.dcloud.net.cn/uniCloud/admin?id=icon-%e5%9b%be%e6%a0%87",text:"如何获取内置图标或使用自定义图标？"}})],1),a("uni-forms-item",{attrs:{name:"url",label:"URL"}},[a("v-uni-input",{staticClass:"uni-input-border",attrs:{placeholder:"菜单url",value:t.formData.url},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("url",n.detail.value)}}})],1),a("uni-forms-item",{attrs:{name:"sort",label:"序号"}},[a("v-uni-input",{staticClass:"uni-input-border",attrs:{placeholder:"菜单序号（越大越靠后）",type:"number",value:t.formData.sort},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("sort",n.detail.value)}}})],1),a("uni-forms-item",{attrs:{name:"parent_id",label:"父菜单标识"}},[a("v-uni-input",{staticClass:"uni-input-border",attrs:{placeholder:"父级菜单标识",value:t.formData.parent_id},on:{input:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("parent_id",n.detail.value)}}})],1),t.permissions.length?a("uni-forms-item",{staticStyle:{"margin-bottom":"60px"},attrs:{name:"permission",label:"权限列表"}},[a("uni-data-checklist",{attrs:{multiple:!0,value:t.formData.permission,range:t.permissions},on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("permission",n.detail.value)}}}),a("v-uni-view",{staticClass:"uni-form-item-tips"},[t._v("当用户拥有以上被选中的权限时，可以访问此菜单，建议仅对子菜单配置权限，父菜单会自动包含。")])],1):t._e(),a("uni-forms-item",{attrs:{name:"enable",label:"是否启用"}},[a("v-uni-switch",{attrs:{checked:t.formData.enable},on:{change:function(n){arguments[0]=n=t.$handleEvent(n),t.binddata("enable",n.detail.value)}}})],1),a("v-uni-view",{staticClass:"uni-button-group"},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.submitForm.apply(void 0,arguments)}}},[t._v("提交")]),a("v-uni-navigator",{staticStyle:{"margin-left":"15px"},attrs:{"open-type":"navigateBack"}},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"}},[t._v("返回")])],1)],1)],1)],1)},u=[]},a383:function(t,n,a){"use strict";a.r(n);var i=a("d8f5"),e=a.n(i);for(var u in i)"default"!==u&&function(t){a.d(n,t,(function(){return i[t]}))}(u);n["default"]=e.a},d8f5:function(t,n,a){"use strict";(function(t){var i=a("4ea4");a("caad"),a("d81d"),a("d3b7"),a("2532"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=i(a("5530")),u=i(a("1a79")),s=t.database(),o=(s.command,"opendb-admin-menus");function r(t){var n={};for(var a in u.default)t.includes(a)&&(n[a]=u.default[a]);return n}var l={data:function(){return{formData:{menu_id:"",name:"",icon:"",url:"",sort:"",parent_id:"",permission:[],enable:null},rules:(0,e.default)({},r(["menu_id","name","icon","url","sort","parent_id","permission","enable"])),permissions:[]}},onLoad:function(t){var n=t.id;this.formDataId=n,this.getDetail(n),this.loadPermissions()},methods:{submitForm:function(t){this.$refs.form.submit()},submit:function(t){var n=this,a=t.detail,i=a.value,e=a.errors;e||(uni.showLoading({title:"修改中...",mask:!0}),this.$request("system/menu/update",Object.assign({_id:this.formDataId},i)).then((function(t){uni.showToast({title:"修改成功"}),n.getOpenerEventChannel().emit("refreshData"),setTimeout((function(){return uni.navigateBack()}),500)})).finally((function(){uni.hideLoading()})))},getDetail:function(t){var n=this;uni.showLoading({mask:!0}),s.collection(o).where({_id:t}).get().then((function(t){var a=t.result.data[0];a&&(n.formData=a)})).catch((function(t){uni.showModal({content:t.message||"请求服务失败",showCancel:!1})})).finally((function(){uni.hideLoading()}))},loadPermissions:function(){var t=this;s.collection("uni-id-permissions").limit(500).get().then((function(n){t.permissions=n.result.data.map((function(t){return{value:t.permission_id,text:t.permission_name}}))})).catch((function(t){uni.showModal({title:"提示",content:t.message,showCancel:!1})}))}}};n.default=l}).call(this,a("a9ff")["default"])},ef93:function(t,n,a){"use strict";a.r(n);var i=a("8ede"),e=a("a383");for(var u in e)"default"!==u&&function(t){a.d(n,t,(function(){return e[t]}))}(u);var s,o=a("f0c5"),r=Object(o["a"])(e["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);n["default"]=r.exports}}]);